     1                                  ;Calcula el valor aproximado de PI
     2                                  ;Utiliza las series Gregory-Leibniz, para lograrlo.
     3                                  
     4                                  ;Objetivo: Calcular PI
     5                                  ;Entradas: -------
     6                                  ;Salidas: el valor aproximado de PI, con presicion de decimales
     7                                  bits 32
     8                                  section .bss
     9                                  
    10 00000000 <res 00000008>          denominador resq 1
    11 00000008 <res 00000002>          numerador resw 1
    12 0000000A <res 00000008>          PI resq 1
    13                                  
    14                                  section .data
    15                                  
    16                                  section .text
    17                                  	global _start
    18                                  _start:
    19 00000000 66C705[00000000]01-     	mov word [denominador],1
    20 00000008 00                 
    21 00000009 66C705[08000000]04-     	mov word [numerador],4
    22 00000011 00                 
    23 00000012 DF2D[00000000]          	fild qword [denominador]	;carga el nuevo denominador
    24 00000018 DE3D[08000000]          	fidivr word [numerador]		;divide el numerador entre el 
    25                                  									;denominador y lo guarda en el tope actual 
    26                                  									;de la pila
    27 0000001E 31C0                    	xor eax,eax					;Limpia el registro eax para alternar entre
    28                                  									;suma y resta
    29                                  									;0x00 -> resta || 0xFF -> suma
    30 00000020 31C9                    	xor ecx,ecx					;Limpia el ecx para llevar un contador de
    31                                  									;la cantidad de series que se realizan
    32 00000022 31D2                    	xor edx,edx					;Limpia el edx para llevar un contador auxiliar
    33                                  									;de la cantidad de series que se realizan
    34                                  									;para llevar valores
    35                                  	
    36                                  incremento:
    37 00000024 BB[00000000]            	mov ebx,denominador			;copia direccion de denominador en ebx
    38 00000029 830302                  	add dword [ebx],2			;suma 2 al valor de denominador
    39                                  actualizar:	
    40 0000002C DF2D[00000000]          	fild qword [denominador] 	;carga el nuevo denominador
    41 00000032 DE3D[08000000]          	fidivr word [numerador]		;divide el numerador entre el 
    42                                  									;denominador y lo guarda en el tope actual 
    43                                  									;de la pila
    44                                  							
    45 00000038 83F800                  	cmp eax,0x00				;decide si lo que sigue es una suma
    46 0000003B 7509                    	jne suma						;o una resta
    47                                  resta:
    48 0000003D DEE9                    	fsubp ST1,ST0				;resta el valor del tope de la pila y lo 
    49                                  									;almacena en el valor anterior al tope
    50                                  									;y hace un pop a la pila
    51 0000003F 35FF000000              	xor eax,0xFF				;Cambia el valor del eax a 0xFF
    52 00000044 EB08                    	jmp comprobar
    53                                  suma:
    54 00000046 DEC1                    	faddp ST1,ST0				;suma el valor del tope de la pila y lo 
    55                                  									;almacena en el valor anterior al tope
    56                                  									;y hace un pop a la pila
    57 00000048 35FF000000              	xor eax,0xFF				;Cambia el valor del eax a 0x00
    58 0000004D 41                      	inc ecx						;Incrementa el contador
    59                                  	
    60                                  comprobar:
    61                                  	;cmp edx,16375
    62                                  	;je aumentar_tope
    63                                  continuar:
    64 0000004E 81F90065CD1D            	cmp ecx,500000000
    65                                  	;cmp ecx,16384
    66 00000054 7406                    	je calcular
    67 00000056 EBCC                    	jmp incremento
    68                                  
    69                                  aumentar_tope:
    70 00000058 D9F7                    	fincstp
    71 0000005A EBF2                    	jmp continuar
    72                                  	
    73                                  calcular:
    74                                  	;faddp ST1,ST0
    75                                  	;faddp ST1,ST0
    76                                  	;faddp ST1,ST0
    77                                  	;fidiv word [numerador]
    78 0000005C DF2D[00000000]          	fild qword [denominador]
    79                                  imprimir:
    80 00000062 DD15[0A000000]          	fst qword [PI]
    81                                  
    82                                  salir:
    83 00000068 BB00000000              	mov ebx,0
    84 0000006D B801000000              	mov eax,1
    85 00000072 CD80                    	int 0x80
    86                                  	
